worker_processes auto;

error_log  /proc/self/fd/2 error;

events {
  worker_connections  512;
}

http {
  include       mime.types;
  default_type  application/octet-stream;

  access_log  /proc/self/fd/1;

  sendfile        on;

  keepalive_timeout  65;

  server {
    listen       80;
    server_name  localhost;
    chunked_transfer_encoding off;

    gzip_static on;

    gzip_http_version   1.1;
    gzip_proxied        expired no-cache no-store private auth;
    gzip_disable        "MSIE [1-6]\.";
    gzip_vary           on;

    root /usr/share/nginx/html;
    index index.html index.htm;

    server_name localhost;

    error_page 405 = $uri;

    location /unavailable {
      return 503;
    }

    location /cold_shoulder {
      return 499;
    }

    location /too_many_requests {
      return 429;
    }

    location /slow {
      default_type text/html;
      access_log off;
      let $sleep 3 + ( $connections_active / 1000 );
      echo_location_async /header;
      echo_flush;
      echo "<div class='glitch' data-text='$echo_timer_elapsed seconds'>$echo_timer_elapsed seconds</div></body></html>";
    }

    location /random {
      default_type text/html;
      access_log off;
      set $from 1;
      set $to 5;
      set_random $random $from $to;
      echo_sleep $random;
      echo_location_async /header;
      echo_flush;
      echo "<div class='glitch' data-text='$echo_timer_elapsed seconds'>$echo_timer_elapsed seconds</div></body></html>";
    }

    location /degrading {
      default_type text/html;
      access_log off;
      let $sleep 1 + ( $connections_active / 1000 );
      echo_sleep $sleep;
      echo_location_async /header;
      echo_flush;
      echo "<div class='glitch' data-text='$echo_timer_elapsed seconds'>$echo_timer_elapsed seconds</div></body></html>";
    }

    location /uncacheable {
      default_type text/html;
      access_log off;
      echo_sleep 2;
      echo_location_async /header;
      echo "<div class='glitch' data-text='Not Cached ...'>Not Cached ...</div></body></html>";
    }

    location / {
      default_type text/html;
      access_log off;
      echo_location_async /header;
      echo_flush;
      echo "<div class='glitch' data-text='Smooth Scaling'>Smooth Scaling</div>";
      echo "<pre>";
      echo_location_async /status;
      echo "</pre>";
      echo "</body></html>";
    }

    location /headers {
      default_type text/html;
      echo_location_async /header;
      echo_sleep $echo_timer_elapsed;
      echo_flush;
      echo "<div class='glitch' data-text='Smooth Scaling'>Smooth Scaling</div>";
      echo "<pre>$echo_client_request_headers</pre>";
      echo "</body></html>";
    }

    location /header {
      default_type text/html;

      echo -n "<!DOCTYPE html><html lang='en'><head><meta name='apple-mobile-web-app-capable' content='yes'><meta http-equiv='refresh' content='5'><meta charset='utf-8'><title>loadtest.flood.io</title></head><style>";

      echo -n "body{background:#000;font-family:Varela,sans-serif}.glitch{color:#fff;font-size:75px;position:relative;width:526px;margin:0 auto}.glitch:after,.glitch:before{content:attr(data-text);position:absolute;top:0;color:#fff;background:#000;overflow:hidden}@keyframes noise-anim{0%{clip:rect(34px,9999px,10px,0)}5%{clip:rect(87px,9999px,13px,0)}10%{clip:rect(48px,9999px,72px,0)}15.0%{clip:rect(6px,9999px,75px,0)}20%{clip:rect(76px,9999px,46px,0)}25%{clip:rect(56px,9999px,32px,0)}30.0%{clip:rect(82px,9999px,30px,0)}35%{clip:rect(48px,9999px,34px,0)}40%{clip:rect(48px,9999px,4px,0)}45%{clip:rect(19px,9999px,72px,0)}50%{clip:rect(99px,9999px,68px,0)}55.0%{clip:rect(36px,9999px,61px,0)}60.0%{clip:rect(34px,9999px,85px,0)}65%{clip:rect(69px,9999px,7px,0)}70%{clip:rect(6px,9999px,5px,0)}75%{clip:rect(3px,9999px,87px,0)}80%{clip:rect(31px,9999px,88px,0)}85.0%{clip:rect(88px,9999px,92px,0)}90%{clip:rect(88px,9999px,46px,0)}95%{clip:rect(44px,9999px,56px,0)}100%{clip:rect(78px,9999px,43px,0)}}.glitch:after{left:2px;text-shadow:-1px 0 red;clip:rect(0,900px,0,0);animation:noise-anim 5s infinite linear alternate-reverse}@keyframes noise-anim-2{0%{clip:rect(75px,9999px,60px,";

      echo -n "0)}5%{clip:rect(49px,9999px,89px,0)}10%{clip:rect(6px,9999px,30px,0)}15.0%{clip:rect(6px,9999px,41px,0)}20%{clip:rect(44px,9999px,25px,0)}25%{clip:rect(95px,9999px,73px,0)}30.0%{clip:rect(30px,9999px,67px,0)}35%{clip:rect(18px,9999px,84px,0)}40%{clip:rect(15px,9999px,95px,0)}45%{clip:rect(83px,9999px,37px,0)}50%{clip:rect(58px,9999px,80px,0)}55.0%{clip:rect(76px,9999px,34px,0)}60.0%{clip:rect(55px,9999px,33px,0)}65%{clip:rect(84px,9999px,85px,0)}70%{clip:rect(50px,9999px,100px,0)}75%{clip:rect(99px,9999px,50px,0)}80%{clip:rect(81px,9999px,3px,0)}85.0%{clip:rect(40px,9999px,9px,0)}90%{clip:rect(67px,9999px,86px,0)}95%{clip:rect(50px,9999px,24px,0)}100%{clip:rect(76px,9999px,93px,0)}}.glitch:before{left:-2px;text-shadow:1px 0 #00f;clip:rect(0,900px,0,0);animation:noise-anim-2 5s infinite linear alternate-reverse}";

      echo -n "img.displayed {padding-top:150px;display: block;margin-left: auto;margin-right: auto } pre{width:526px;margin:0 auto;font-size:18px;color:#fff;background:#000}";

      echo -n "</style><body>";

      echo -n "<img class='displayed' width='131' height='131' title=' alt=' src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIMAAACDCAYAAACunahmAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA/dpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NTc3MiwgMjAxNC8wMS8xMy0xOTo0NDowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ1dWlkOjVEMjA4OTI0OTNCRkRCMTE5MTRBODU5MEQzMTUwOEM4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjc1RjA0RjM0RjZENTExRTRBNUM4OTZCQzI1ODU1MDE2IiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjc1RjA0RjMzRjZENTExRTRBNUM4OTZCQzI1ODU1MDE2IiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIElsbHVzdHJhdG9yIENDIDIwMTQgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpmMmVkMWMxNi0xMDAxLTQxYzEtOGRmMi1kNzNmNjgyZGZjOGEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6ZjJlZDFjMTYtMTAwMS00MWMxLThkZjItZDczZjY4MmRmYzhhIi8+IDxkYzp0aXRsZT4gPHJkZjpBbHQ+IDxyZGY6bGkgeG1sOmxhbmc9IngtZGVmYXVsdCI+UHJpbnQ8L3JkZjpsaT4gPC9yZGY6QWx0PiA8L2RjOnRpdGxlPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PoqMzPsAAAxmSURBVHja7J3tcSI5EIa11AbARnDjqvvvcQRmIzAbgZkIwBHYjgA7AuMIzEbgcQTA/6tiMjgy2JtmW9x4dgB1q6X5kqqmuA8Mg/TM261Wq/Xl169fqovt7+hilL9EeP2Fr8P8igkfk+EF7SO/";

      echo -n "dvm1huufbLvrWp996QIM+cDHOMjX+Bp7+NoMwdjkV5rDkQYY6hl8eMLhyb/B16gBtwVKkaKCLHM4sgCDWwgmCMC4BbcLqvGaX4u2mJTGw4AmYIoADFuqwEsAI4diGWDgq8AtmoGuNDAdz01Vi8bBgBDcN8QPcOlfABRPTYKiMTD0BIJGQ1E7DBgPmHuaDjbZfDzmQCx6CQNOD19aMjPw1WBqepdDsa7jywc1gTDLX7YBhD8aqOQq75+HzisDqsFbTTOEFF8/SvKcVQyIbpfq/xC272ktqEPiUyW8wZCDMEaz4LpTdSRwg6+ZRDQQQdah7kvlL/IJZuOpMzDkHQkO4szxU/RT/Q4De3uS8t8Voam7dmzylqgSu9bC4Ngs6HBvI9YB8LcCELcOf69Ts+EMBgwjvzmQUph+PdflcRMUA0LoE2GzCMrw3dVvdwIDgvAu2BGNjNgR1EI6mJa4iEmIw4CRxJc+Q3CiX+aCD4g4EKIwCIOwQE+6MxlFqBQzVIrGASEGgyAI3ufXNfkUL0KOphgQIjAIggDx+QfVk4aR2HsB0yEChDUM6CyughrUrhLWQFjBIDRr6JxvwOzLBwFf4srmgWLDgM7QynLKlNS9bNswIGxD9lZxCJtVy3cLEPRNBxAKDXMkv2P/cNo+LQAfVD8w4FpDbAlCGoa/Egh4qi/Qj+K0GOMZ7mFAKeMuOq2Vw3Bqh4DYoUJw+2mCMxV3PgN6viumTdMg7MJwk/yyd6YKk/0HqjJwnRu4sR8BBK8KodMK5c0Eys7IgtAsDC8biB9MpzKmpNAZmQlL83AVfAQRk2ET07kweRhNlYG72pYEEERnGXfMPzcyFwMDIsE0cFK6FiGOIA4E9CcnH3KEs0BrZeAsQNlQHNppIO6YDuXcCgZcjYwYDmMSZg5OG8ehjM45k+eUgbNw8hj8BOfqAM7gI+NPp6dC1QNhVVj7yvEPQOz7OWXEHmYcZeCoQhKGyWtLJNVhIKgKT8E8tMJcDI/NDo8pw5ThND6G4amlPTGcyUrV/yMCiXGFd4bT+BDG5RCtLarqzrVi4lIBddn6jzSCKhggrjAhqsJFn6eShRT42yPmFfpmiQ9N5ugetkTTDkHB5KiZwB81Id7Hc89BAPu7Vad3Tel+XXHyDAzbK/H9k7IjWfYZqGHnneKFR7sCAgzwmzJft4H3zVF9m+A7jE/BcEP8sGVfVcFyr8hEujoLjsOC+Gc3lT4DSsa/xA+76uleB46TXdV+SBYKRed1S/yzb/qBHliYiHVPQRgquf2k7EzmE3EH6piMq8zEtWOHpSttpuS21w+V3Cbcg0PPNRU2yrDooSoABFNpuPBzpRrV7Iw+wYApVRS5WvfUcZwqNwXKxNQBxyWlqBOO/0EZRsFEGPkKE0cfP5H0HdTvYmdkdRgw/YW0h6owIaiC3iaXED9fqlHH57oIA2WTxq6nq5OmvoLO9EoxZ/FR+PNNTMVa0QJQn8xEFFThbFzBtI/K4XnTCG2kbXcN6gDfPRzgD6W0TQ9V4Zbw3qcKh27pWx0Y4xQPGHPmPvoLptPuYyfMvAp/";

      echo -n "j4txijgw9MpfwFVJU8fx9YgNXxra8KHJ/gZH47SH4ZLoPPYtvmC6eLc+U3NiQfHsheINlLG6HChisCmYCJoq1GwqKOM1/Eo0E15VoVS1vQpaODvC2WmzRBOxODfdyz8vM+jv/axCaPpOGa+ICsPGEwQww4EQ7bmZzv592MmvDvIwTU2EaV4HLCLNDdVBAoYNQWmiWo4lOgHBEOtFvStaiDxCKLaMqbKEZJuGf5fCEIq2QZNAQAhscgQBineJPEOCidiZ7jYn5BvEwiuZTmBYOwZBKgInkWd4I/y0Ux1JCYVbu4Rh1wIQdLPNM5Q2EbqlwjCKjVcTzMSLcnfA6T0mrlIBnRBMBEkZcJaQeVKG9vgMaNtdn205ZywAuTIRlL8bCjvD4jAMBUGIlHz+37F7fiHelysTUYyP+DAVQ5cwSMo5tWgYSCusCD4yHFlKCTzTlcOMm+ZOWKuwVYbYJQxSqjAimgdYDYT9nHAUwUN+XSl6we37c7JLTG2z3e+wNITY2xSzLp/hhQhCUvF0pQwg3s7kGs4IavVs2QemJmbsE4aM8P5rAVUAuTalPa0CoeSZU4DQ09hjvsKUcF+ZTT8QTIVNwgtlvDIqDLYgxASncZ9LaDhVo5QZBOmt2slEqYstlR1uYioiT7OKPQzkxEkmCNRtaca1DDAcTLHh4BfA9ngITEHBTMoRzZlgsVNTU8GddZESnQEGykrk0CK/n3JgCadqXEIEO0I434l2WaxcEZoKE+BH1AwoHCfKWG04ZiKm3hSjGswdo2N19XWnUuqgBLKpyaFu0qWqOMtnGBlCEGFYd0UE4YmbrIJ/57LQmIvPNlXAvfNLAGJEhoHR8ZdnIBjnFwCwRRmmzJOtq8ZhgsvSwaClLgqjE4tsxAhEbDtOVQ+SjjNkEsqA5uDNwtGUqjkN/oPkcrtrE/";

      echo -n "RI8Hdi7fwKKkOm4wyK2HHDKjLx5iYWHfIkVcVE4MCvMghOz9bCWRM1iPVyzKlk7KpPizB8EG9kJBwcWWPpfGn5/a7s6khYHRrKMG/U75kL+QubIgxUv+FGMAaho4guOniHEcwfDEe5jmMXOdPjqnZL/N79+BcLfP1LlJZvRelEpzFmdriXFHw0ZTdn4gpwT891naJDrSKX3+eX8ixO0Yp8wQPzDf7ha+E/Lok2f1KaFv0kwuC9xDAO8AI7bXTEXNW6YwzuMb83bQLOPZxVwFIXtg5+WlEZSERix12VqDRRB102N1SgPxOnwfEYnfBnrsohe4ZCHw6nF68DiVDdVkxdwElZhvMtyVDE2J/FAf7A2deu4r0r4lcczP2nQuK4YENNOgkHjjQHHGrYHx7OQ/yknNxCzekbCxemCo0PwpDhL3wa78ExZ8KwnTzzKDSvjZKlpX2O5VEYmMWop0EdGqEK1KDfH5uFq3IgX4M6dF4VKse58mB0xvSk96fR1KwKW0Wv8HtV/o/HsqOfGepwH4amlnbPUIXK8a1UBiSOeuZRZdwhNOcxCGpcAbK1Lqr+x6l9E5wkk3kYIq+N099Hx/WoMliow104AtmLKnCOLzyqCueUgasO98Jlb0OrNg/3kqpwVhks1KHSWw1NbPbAKW5yUhVMlAEaZ+0hdnRcX2i0/SekcTwLA2ZPc3ITJ5yqKaGdVAXoT06fLk2y4E13YUN+Iieg9BL8B1E/gaO2O2W4KckIBsxB4O5neA9AiIDAPUfTeM/qWQeydFPUYp1FOkO4mu8wUsPNusHGH+NkY2qxDmr2rm7UrWGhfZ45DJkPIMn5J8GAcsPNbIoDEF6mkIcHl5piSC7jg7ueFhZAbIMPYeQjbC1AYO1OI/kMpRteWdyst51KLXYWuQrKDvjZFPiiFtcq+xCrEIeojCOsLEDQWwpZja0MQhQrNDl3fZ9pMDKbxdXWCgb8ESOLOfBB2tDhWfcQAh1MsvWjvtueyGNdBxJvwHbvhJ5pzHoGwkzJVNRPJI5mslaGkr2TWJxK0WysO64GsOA0Evi4RGqTsBgMwkDsp0fqdyh11yEIdK6olAImkrvFRWFwAASA8Kwq9hW2EAIAYKrkKvMn0mUDxGEoOJVvgj+8lVA4gmBfX8rF8Y1OYBCcdlZ1BETWnpvsU+BvBwDGDn6/s2CdMxgKT4aL86f0dBR2BTVim3/heIJbh7/XaZUbpzAUOmqu3G7B02CkPhUDFWDkEADdvJQ+8AIDdtxY0Sq320gp2NMNvoqU5sEnXw/+Jb76+C2JVEnExsCAHRqp06VpXHaqVoyPkqIUQRmWnnB9XkPsYeCr4i2JTxPoFYYCFDPF2yPYh7bD+Ir3jUi1wFBQibnyeOxOCxqYg7u6HOLaYCjFJKgFx7vWMiW0vtBqGApQTNB0RD2D4LGuAqSNhaFnUDQKgsbCUIJi6nj+7rvVWoq4tTCUfIpbJR/a9dlg8F/r9glaD0MBCl3n8Fwh8CbNDKDO4rIti2utgeEIGNcNUgy9iPbRJgBaD0MFHOUwsQ/nM0MfAAY/7UJmVidgOOFrRHhdonpERFAyvOAp3+h/b7rt57b/BBgAamoCchpSZ7wAAAAASUVORK5CYII=' />";

    }

    location /status {
      stub_status on;
      access_log off;
    }
  }
}